<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Netflix Clone with Video Player - Premium Streaming</title>
<link href="https://fonts.googleapis.com/css2?family=Inter&family=Material+Icons" rel="stylesheet" />
<!-- <script src="clone.js" defer></script> -->
<style>
  /* Reset and base */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  html, body {
  overflow: auto;
  -ms-overflow-style: none;  
  scrollbar-width: none;     
}

html::-webkit-scrollbar,
body::-webkit-scrollbar {
  display: none;             
}

  html {
    font-size: 16px;
    scroll-behavior: smooth;
  }
  body {
    margin: 0;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    background-color: #141414;
    color: #fff;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    user-select: none;
    overflow-x: hidden;
  }
  a {
    color: inherit;
    text-decoration: none;
  }
  img {
    display: block;
    max-width: 100%;
    height: auto;
  }
  ul {
    list-style: none;
    padding-left: 0;
  }

  ::-webkit-scrollbar {
    height: 8px;
    width: 8px;
  }
  ::-webkit-scrollbar-track {
    background: #222;
  }
  ::-webkit-scrollbar-thumb {
    background: #555;
    border-radius: 6px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: #777;
  }

  /* Variables */
  :root {
    --netflix-red: #e50914;
    --netflix-dark: #141414;
    --netflix-gray: #333;
    --netflix-lightgray: #999;
    --glass-bg: rgba(20, 20, 20, 0.7);
    --glass-bg2: rgba(20, 20, 20, 0.85);
    --shadow-color: rgba(0,0,0,0.7);
    --transition-fast: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Utility */
  .flex {
    display: flex;
  }
  /* .flex-center {
    justify-content: center;
    align-items: center;
  } */
  .hidden {
    display: none !important;
  }
  .sr-only {
    position: absolute !important;
    width: 1px; height: 1px; padding: 0; margin: -1px;
    overflow: hidden; clip: rect(0,0,0,0); border: 0;
  }
  button {
    font-family: inherit;
    font-size: 1rem;
    cursor: pointer;
    background: none;
    border: none;
    color: inherit;
  }
  button:focus-visible {
    outline: 2px solid var(--netflix-red);
    outline-offset: 2px;
  }
  input, select {
    font-family: inherit;
    font-size: 1rem;
  }
  /* Hover only on devices supporting hover */
  @media (hover: hover) and (pointer: fine) {
    button:hover {
      color: var(--netflix-red);
    }
    a:hover {
      color: var(--netflix-red);
    }
  }

  /* HEADER */
.header {
  position: fixed;
  top: 0;
  left: 280px; /* shift right because of sidebar */
  right: 0;
  height: 8px;
  background-color: #111;
  display: flex;
  align-items: center;
  justify-content: space-between;
  z-index: 1000; /* ensures it stays above banner video */
  padding: 0 24px;
}
  .brand {
    font-size: clamp(1.75rem, 2vw, 1.95rem);
    font-weight: 1000;
    letter-spacing: 2.5px;
    color: var(--netflix-red);
    user-select: none;
    margin:5px 10px;
    position: fixed;
  }
  /* Navigation links - desktop */
  nav.desktop-nav div{
    position: relative;
    margin:80px 2px;

  }
    nav.desktop-nav div.search-wrapper{
    margin:10px 0px;
  }
      nav.desktop-nav div.theme-switch{
        position: inherit;
       top:0px;
    margin:8px 1250px;

  }
  nav.desktop-nav {
  position: fixed;
  top: 0;
  left: 280px; /* since sidebar is 280px */
  right: 0;
  height: 110px;
  background-color: #111;
  color: white;
  display: flex;
  align-items: center;
  justify-content:flex-end;
  gap:0px;
  z-index: 1000; /* 👈 Must be higher than banner/video */
  padding: 0 2px;
  }
  nav.desktop-nav a {
    font-weight: 500;
    font-size: 1rem;
    padding: 8px;
    white-space: nowrap;
    transition: color var(--transition-slow);
    margin:0px 20px;
  }
  nav.desktop-nav a[aria-current="page"] {
    color: var(--netflix-red);
    font-weight: 700;
  }

  /* Search Bar */
  .search-wrapper {
    position: fixed;
    width: 180px;
    margin-top:70px ;
    margin:160px 0px;
    /* z-index: 100; */
  }
  .search-wrapper input[type="search"] {
    background: var(--netflix-gray);
    border-radius: 20px;
    border: none;
    padding: 6px 48px 6px 16px;
    color: #fff;
    width: 100%;
    transition: background 0.3s;
    transition: width 0.8s ease;
  }
  .search-wrapper input[type="search"]:focus {
     transform: translatex(-20px);
    width: 200px;
    outline: none;
    background: #222;
  }
  .search-wrapper .material-icons-outlined {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--netflix-lightgray);
    pointer-events: none;
  }
  .merge{
    display: flex;
    align-items: center;
    justify-content:right;
    gap:2px;
    padding :5px;
    margin: 0px 0px;
  }
  /* Profile dropdown */
  .profile {
    position: relative;
    margin:23px 1480px;
  }
  .profile-btn {
    margin:0px 0px;
    display: flex;
    align-items: center;
    cursor: pointer;
    border-radius: 50%;
    overflow: hidden;
    width: 43px;
    height: 40px;
    border: 2px solid transparent;
    transition: border-color var(--transition-fast);
    background: var(--netflix-gray);
    flex-shrink: 0;
  }
  .profile-btn:focus-visible {
    border-color: var(--netflix-red);
  }
  .profile-btn img {
    margin:0;
    padding: 0;
    /* vertical-align: middle; */
    aspect-ratio: 1/1;
    width: 900px;
    height:45px;
    border-radius: 50%;
    object-fit:cover;
    overflow: hidden;
    display: block;
  }
  .profile-dropdown {
    position: absolute;
    top: 52px;
    right: 0;
    background: var(--glass-bg2);
    border-radius: 10px;
    width: 200px;
    box-shadow: 0 8px 24px var(--shadow-color);
    backdrop-filter: saturate(180%) blur(30px);
    visibility: hidden;
    opacity: 0;
    transform: translateY(5px);
    transition: opacity 0.3s ease, transform 2s ease, visibility 0.3s;
    z-index: 1200;
  }
  .profile-dropdown.active {
    visibility: visible;
    opacity: 1;
    transform: translateY(0);
  }
  .profile-dropdown ul {
    padding: 12px 0;
    margin: 0px 0px;
  }
  .profile-dropdown ul li {
    padding: 8px 20px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background 0.5s;
  }
  .profile-dropdown ul li:hover,
  .profile-dropdown ul li:focus-visible {
    background: var(--netflix-red);
    color: white;
    outline: none;
  }

  /* SIDEBAR */
aside.sidebar {
  position: fixed;
  top: 64px; /* height of top navbar */
  left: 0;
  width: 260px;
  height: calc(100vh - 64px);
  background-color: rgba(0, 0, 0, 0.95); /* keep slightly transparent if needed */
  z-index: 1000;
}

  
  aside.sidebar nav {
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  aside.sidebar nav a {
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 600;
    font-size: 1rem;
    color: #ddd;
    padding: 8px 16px;
    border-radius: 12px;
    transition:
      background 0.3s,
      color 0.3s;
  }
  aside.sidebar nav a.active,
  aside.sidebar nav a:focus-visible {
    background: var(--netflix-red);
    color: #fff;
    outline: none;
  }
  aside.sidebar nav a:hover:not(.active) {
    background: #222;
  }
  .material-icons.sidebar-icon {
    font-size: 24px;
    color: inherit;
  }
  .badge {
    background: var(--netflix-red);
    color: white;
    font-size: 0.75rem;
    padding: 2px 6px;
    border-radius: 12px;
    margin-left: auto;
  }

  /* Sidebar scrollbar */
  aside.sidebar::-webkit-scrollbar {
    width: 8px;
  }
  aside.sidebar::-webkit-scrollbar-track {
    background: transparent;
  }
  aside.sidebar::-webkit-scrollbar-thumb {
    background: var(--netflix-red);
    border-radius: 6px;
  }
  /* Banner Section */
.banner-section{
    background-repeat: no-repeat;
    background-size: cover;
    min-height: 98vh;
    padding-top: 80px;
    position: relative;
}
.banner-content{
    display: flex;
    flex-direction: column;
    padding-top: 70px;
}
.banner__title{
    color: white;
    font-size: 84px;
    line-height: 1.1;
    margin: 0;
    margin-bottom: 16px;
    max-width: 40%;
}
.banner__info{
    margin-bottom: 14px;
    font-size: 22px;
    font-weight: 700;
    line-height: 1.5;
    color: white;
}
.banner__overview{
    font-size: 16.4px;
    color: white;
    line-height: 1.3;
    max-width: 40%;
}
.action-buttons-cont{
    display: flex;
    flex-direction: row;
    align-items: center;
}
.action-button{
    border:none;
    background-color: white;
    padding: 8px 23px;
    margin-right: 11px;
    border-radius: 4px;
    display: flex;
    align-items: center;
    flex-direction: row;
    font-size: 16px;
    font-weight: 700;
    cursor:pointer;
}
.action-button:last-child{
    background-color: rgba(109, 109, 110, 0.7);
    color:white;
}
.banner_fadeBottom{
    height: 120px;
    background:linear-gradient(180deg,
        transparent,
        rgba(37,37,37,.61),
        #141414
    );
    position: absolute;
    left:0;
    bottom: 0;
    width: 100%;
}



/* RESPONSIVE CSS */
@media (max-width:767px) {
    .main-nav{
        display: none;
    }
    .banner__overview, .banner__title{
        max-width: 100%;
    }
}

  /* MAIN CONTENT */
main {
  margin-left: 280px;
  padding: 40px;
  padding-top: 0; /* 👈 remove the 100vh */
  background-color: #111;
  color: #fff;
  position: relative;
  top: 0; /* ensures no offset */
}

  @media (max-width: 1023px) {
    main {
      margin-left: 0;
      padding: 24px 16px 80px;
    }
  }

  /* Rows - movie/show categories */
  .row {
    margin-bottom: 48px;
  }
  .row > header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
  }
  .row title {
    font-size: 1.5rem;
    font-weight: 700;
  }
  /* Horizontal scroll container */
  .row-list {
    display: flex;
    gap: 16px;
    overflow-x: auto;
    /* scrollbar-width: thin;
    scrollbar-color: var(--netflix-red) transparent; */
  }

  .row-list:focus {
    outline: none;
  }
  /* Movie cards */
  .card {
    position: relative;
    flex: 0 0 auto;
    width: 250px;
    height: 367px;
    border-radius: 12px;
    overflow: hidden;
    background: #222;
    cursor: pointer;
    transition: transform 0.3s cubic-bezier(0.4,0,0.2,1), box-shadow 0.3s ease;
  }
  .card:hover,
  .card:focus-visible {
    transform: scale(1.15);
    box-shadow: 0 16px 28px rgba(229,9,20,0.6);
    z-index: 10;
    outline: none;
  }
  .card img {
    width: 100%;
    height: 300px;
    object-fit: cover;
    border-radius: 12px 12px 0 0;
    user-select: none;
    pointer-events: none;
  }
  .card-title {
    padding: 8px 12px;
    font-size: 0.95rem;
    font-weight: 600;
    color: #eee;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
  }
  .card-details {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 8px 8px;
    background: linear-gradient(0deg, rgba(20, 20, 20, 0.9) 0%, transparent 100%);
    font-size: 0.8rem;
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .card-rating {
    display: flex;
    align-items: center;
    gap: 4px;
    font-weight: 700;
  }
  .card-rating .material-icons {
    font-size: 16px;
    color: var(--netflix-red);
  }
  .card-fav {
    cursor: pointer;
    background: transparent;
    border: none;
    padding: 0;
  }
  .card-fav .material-icons {
    font-size: 20px;
    color: var(--netflix-gray);
    transition: color 0.3s ease;
  }
  .card-fav.favorited .material-icons {
    color: var(--netflix-red);
  }


.row-list::-webkit-scrollbar {
  display: none;             /* Chrome, Safari, Opera */
}

  /* Play overlay on card hover */
  .card:hover .play-overlay,
  .card:focus-visible .play-overlay {
    opacity: 1;
  }
  .play-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 24px;
    background: rgba(0,0,0,0.5);
    border-radius: 12px 12px 0 0;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
  }
  .play-button {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--netflix-red);
    padding: 8px 14px;
    border-radius: 40px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    pointer-events: auto;
    user-select: none;
    box-shadow: 0 4px 12px rgba(229, 9, 20, 0.6);
    transition: background 0.3s ease;
  }
  .play-button:hover,
  .play-button:focus-visible {
    background: #b90712;
    outline: none;
  }
  .play-button .material-icons {
    font-size: 20px;
  }

  /* FOOTER */
  footer {
    padding: 24px;
    background: var(--glass-bg2);
    color: #bbb;
    text-align: center;
    font-size: 0.85rem;
    backdrop-filter: saturate(180%) blur(20px);
    border-top: 1px solid rgba(255,255,255,0.05);
  }
  footer a {
    color: var(--netflix-red);
    margin: 0 8px;
    font-weight: 600;
  }
  footer a:hover,
  footer a:focus-visible {
    color: #fff;
    outline: none;
  }

  /* MOBILE MENU */
  .mobile-header {
    display: none;
  }
  @media (max-width: 767px) {
    header nav.desktop-nav {
      display: none;
    }
    .mobile-header {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .hamburger-btn {
      font-family: 'Material Icons';
      font-size: 32px;
      color: var(--netflix-red);
      cursor: pointer;
      user-select: none;
      border: none;
      background: transparent;
      line-height: 1;
      padding: 0;
      width: 44px;
      height: 44px;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 8px;
    }
    .hamburger-btn:focus-visible {
      outline: 2px solid var(--netflix-red);
      outline-offset: 2px;
    }
.sidebar {
  position: fixed;
  top: 64px; /* height of top navbar */
  left: 0;
  width: 260px;
  height: calc(100vh - 64px);
  background-color: rgba(0, 0, 0, 0.95); /* keep slightly transparent if needed */
  z-index: 1000;
}

    aside.sidebar.open {
      left: 0;
      box-shadow: 4px 0 8px rgba(0,0,0,0.8);
    }
    main {
      margin-left: 0 !important;
      padding: 16px 16px 80px !important;
    }
    /* Bottom navigation bar */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 56px;
      background: var(--glass-bg2);
      backdrop-filter: saturate(180%) blur(20px);
      border-top: 1px solid rgba(255,255,255,0.05);
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 1400;
    }
    .bottom-nav button {
      background: transparent;
      border: none;
      color: #ddd;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      transition: color 0.3s;
      font-weight: 600;
      min-width: 44px;
      min-height: 44px;
    }
    .bottom-nav button.active,
    .bottom-nav button:focus-visible {
      color: var(--netflix-red);
      outline: none;
    }
    .bottom-nav .material-icons {
      font-size: 28px;
      line-height: 1;
    }
    /* Hide footer on mobile to avoid clutter */
    footer {
      display: none;
    }
  }

  /* SKELETON LOADER */
  .skeleton {
    position: relative;
    background-color: #333;
    overflow: hidden;
  }
  .skeleton::after {
    content: '';
    position: absolute;
    top: 0;
    left: -150px;
    width: 100px;
    height: 100%;
    background: linear-gradient(90deg,
      rgba(255, 255, 255, 0),
      rgba(255, 255, 255, 0.2),
      rgba(255, 255, 255, 0));
    animation: loading 1.5s infinite;
  }
  @keyframes loading {
    0% {
      left: -150px;
    }
    50% {
      left: 100%;
    }
    100% {
      left: 100%;
    }
  }

  /* TOAST NOTIFICATIONS */
  .toast-container {
    position: fixed;
    top: 72px;
    right: 24px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    max-width: 320px;
    z-index: 1500;
  }
  .toast {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.7);
    color: white;
    background: var(--netflix-red);
    animation: slideInRight 0.2s ease forwards;
  }
  .toast.info {
    background: #2196F3;
  }
  .toast.success {
    background: #4CAF50;
  }
  .toast.error {
    background: #f44336;
  }
  .toast .material-icons {
    font-size: 28px;
  }
  .toast .toast-close-btn {
    margin-left: auto;
    cursor: pointer;
    font-size: 24px;
    background: transparent;
    border: none;
    color: white;
  }
  .toast .toast-close-btn:focus-visible {
    outline: 2px solid #fff;
    outline-offset: 2px;
  }
  @keyframes slideInRight {
    from {
      opacity: 0;
      transform: translateX(100%);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* SWITCH THEME TOGGLE */
  .theme-switch {
    position: relative;
    margin: 0px 1200px;
    display: flex;
    align-items: center;
    cursor: pointer;
    gap: 0px;
  }
  .theme-switch input[type="checkbox"] {
    margin:10px 10px;
    width: 40px;
    height: 20px;
    appearance: none;
    background: #555;
    border-radius: 100px;
    position: relative;
    outline: none;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  .theme-switch input[type="checkbox"]:checked {
    background: var(--netflix-red);
  }
  .theme-switch input[type="checkbox"]::before {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: white;
    transform: translateX(0);
    transition: transform 0.3s;
  }
  .theme-switch input[type="checkbox"]:checked::before {
    transform: translateX(20px);
  }
  .theme-switch p {
    font-size: 0.9rem;
    user-select:none;
  }

  /* DRAG & DROP Helper */
  .dragging {
    opacity: 0.6;
  }

  /* TOOLTIPS */
  .tooltip {
    position: relative;
    display: inline-block;
  }
  .tooltip:hover .tooltip-text,
  .tooltip:focus-within .tooltip-text {
    visibility: visible;
    opacity: 1;
    transform: translateY(0);
  }
  .tooltip-text {
    visibility: hidden;
    opacity: 0;
    width: max-content;
    max-width: 160px;
    background: var(--netflix-red);
    color: white;
    text-align: center;
    border-radius: 6px;
    padding: 6px 10px;
    position: absolute;
    z-index: 1700;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%) translateY(8px);
    transition: opacity 0.3s ease, transform 0.3s ease;
    pointer-events: none;
    font-size: 0.8rem;
    user-select: none;
  }
  .tooltip-text::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -6px;
    border-width: 6px;
    border-style: solid;
    border-color: var(--netflix-red) transparent transparent transparent;
  }

  /* VIDEO PLAYER MODAL */
  .video-modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    backdrop-filter: saturate(180%) blur(20px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 2000;
    visibility: hidden;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .video-modal.active {
    visibility: visible;
    opacity: 1;
  }
  .video-player-container {
    position: relative;
    max-width: 1050px;
    /* max-height: 900px; */
    width: 90vw;
   /* max-height: 500vh;  */
   /* height: 450px; */
    background: #000;
    margin: auto;
    border-radius: 16px;
    box-shadow: 0 8px 36px rgba(229,9,20,0.85);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
/* Aspect dropdown styling */
.aspect-container {
  margin-top: 20px;
  opacity: 0;
  transform: translateY(-10px);
  animation: fadeInSlide 0.5s ease forwards;
}

@keyframes fadeInSlide {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

  .video-wrapper {
  width: 100%;
  height: 480px;
  overflow: hidden;
  background: black;
  border-radius: 8px;
}
  video#videoPlayer {
    width: 100%;
    height: 100%;
    height: auto;
    background: black;
    outline: none;
    max-height: 100%;
    object-fit:contain;
    transition: object-fit 0.3s;
  }
#aspect {
  padding: 8px 12px;
  font-size: 16px;
  border: none;
  background: #222;
  color: #fff;
  border-radius: 6px;
  transition: all 0.3s ease;
}
.aspect:hover {
  background-color: #333;
  transform: scale(1.02);
}


/* Dropdown fixes for Chrome, Firefox */
#aspect option {
  background-color: #1e1e1e;
  color: white;
  padding: 5px;
}
  select#aspect {
  background: #222;
  color: white;
  padding: 5px 10px;
  border-radius: 4px;
  box-shadow: 2x 2px 5px #e50914;
}

/* Additional styles for custom aspect sizes */
.video-wrapper.cinema {
  aspect-ratio: 21 / 9;
}

.video-wrapper.portrait {
  aspect-ratio: 9 / 16;
}

.video-wrapper.centered-cover video {
  object-fit: cover;
  object-position: center center;
}
  .video-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(0,0,0,0.8);
    padding: 8px 12px;
    font-size: 14px;
    user-select: none;
  }
  .control-buttons {
    display: flex;
    gap: 12px;
    align-items: center;
  }
  .control-buttons button {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 20px;
    display: flex;
    align-items: center;
  }
  .control-buttons button:focus-visible {
    outline: 2px solid var(--netflix-red);
    outline-offset: 2px;
  }
  .progress-bar {
    /* -webkit-appearance: none; */
    width: 100%;
    margin: 0 12px;
    cursor: pointer;
    height: 6px;
    background: #444;
    border-radius: 3px;
    overflow: hidden;
  }
  .progress-bar::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 14px;
    height: 14px;
    background: var(--netflix-red);
    cursor: pointer;
    border-radius: 50%;
    border: none;
    margin-top: -4px;
  }
  .progress-bar::-moz-range-thumb {
    width: 14px;
    height: 14px;
    background: var(--netflix-red);
    cursor: pointer;
    border-radius: 50%;
    border: none;
  }
  .time-display {
    min-width: 50px;
    text-align: center;
    font-variant-numeric: tabular-nums;
  }
  .close-video-btn {
    position: absolute;
    top: 8px;
    right: 12px;
    background: transparent;
    border: none;
    color: white;
    font-size: 30px;
    cursor: pointer;
    z-index: 10;
  }
  .close-video-btn:focus-visible {
    outline: 2px solid var(--netflix-red);
    outline-offset: 2px;
  }
  .video-description {
    background: var(--glass-bg2);
    padding: 12px 16px;
    color: #fff;
    font-size: 0.9rem;
    max-height: 140px;
    overflow-y: auto;
  }
  .video-title {
    font-weight: 700;
    font-size: 1.2rem;
    margin-bottom: 4px;
  }
.menu{

  width: 100%;
  overflow: hidden;
}
.menu a{
  float:left;
  display: block;
}
.submenu{
  display: none;
  position: absolute;
  z-index: 1;
}
.submenu a{
  display: block;
}
.menu a:hover, .submenu:hover{
  background-color: #2196F3;
}
.submenu:hover .submenu{
  display: block;
}
.menu>div:hover .submenu{
  display: block;
}
p{
  margin: 0px 5px;
  font-size: 20px;
}
.banner {
    position: relative;
  width: 100%;
  height: 100vh;
  overflow: hidden;
  position: relative;
  margin-left: 280px; /* width of your sidebar */
  width: calc(100% - 280px);
  height: 100vh;
  overflow: hidden;
  background-color: black;
}
.video-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  pointer-events: none;
}

.video-container iframe {
  width: 100%;
  height: 100%;
  object-fit: cover;
  pointer-events: none;
  border: none;
}
.banner-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent 60%);
  z-index: 0;
}

.banner-content {
  position: relative;
  z-index: 2;
  color: #fff;
  padding: 6rem 4rem 2rem; /* creates space from top */
  max-width: 800px;
}

.banner h1 {
  font-size: 3rem;
  margin-bottom: 1rem;
}

.banner p {
  font-size: 1.2rem;
  line-height: 1.4;
  margin-bottom: 1.5rem;
  max-width: 90%;
}

.banner-buttons {
  display: flex;
  gap: 1rem;
}

.btn {
  position: relative;
  font-size: 1rem;
  padding: 0.5rem 1.5rem;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  background-color: rgba(255,255,255,0.7);
  color: black;
  transition: background-color 0.3s ease, transform 0.3s ease;
  z-index: 2;
}

.btn:hover {
  background-color: white;
  transform: scale(1.05);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Responsive */
@media (max-width: 768px) {
  .banner h1 {
    font-size: 2rem;
  }

  .banner p {
    font-size: 1rem;
  }

  .btn {
    font-size: 0.9rem;
    padding: 0.4rem 1rem;
  }
}
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  z-index: 9999;
  display: none;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.modal-content {
  position: relative;
  width: 80vw;
  max-width: 900px;
  height: 50vw;
  max-height: 506px; /* 16:9 ratio */
  background-color: black;
  border-radius: 8px;
  overflow: hidden;
}

.modal-close {
  position: absolute;
  top: 10px; right: 15px;
  color: white;
  font-size: 2rem;
  font-weight: bold;
  cursor: pointer;
  user-select: none;
  z-index: 10;
  transition: color 0.3s ease;
}

.modal-close:hover {
  color: #bbb;
}
body{
  background-color: #fff;
  color:#111;
  transition: background-color 0.3s color 0.3s;
}
body.dark-theme{
  background-color: #141414;
  color:#fff;
}
body.dark-theme .main-nav,
body.dark-theme .banner,
body.dark-theme .content,
body.dark-theme .card,
body.dark-theme .row,
body.dark-theme .featured{
    background-color: #141414;
  color:#fff;
}
        .san{
            position: relative;
            margin:80px 1405px;
            z-index: 1000000;
            border:0;
            outline: none;
            background: none;
            color:var(--netflix-dark);
            text-transform: uppercase;
            font-size: 19px;
            letter-spacing: 2px;
            font-weight: 900;
            cursor: pointer;
        }
        .sanj{
            position: absolute;
            content: '';
            color:#f5f5f5;
            width:0%;
            inset:0;
            overflow:hidden;
            border-right: 6px solid var(--netflix-red);
            transition: width 1.5s ease;
        }
        .san:hover .sanj{
            width:100%;
            filter:drop-shadow(0 0 3px  var(--netflix-red))
        }

        .fixed-top-wrapper{
          position: fixed;
          top:0;
          left:0;
          width: 100%;
          z-index: 999;
          display:flex;
          
        }
.video-fit-contain video {
  object-fit: contain !important;
}
.video-fit-cover video {
  object-fit: cover !important;
}
.video-fit-fill video {
  object-fit: fill !important;
}

</style>
</head>
<body>
<header role="banner" aria-label="Main header with navigation and user profile">
  <div class="fixed-top-wrapper">
          <button class="san">
        &nbsp;SANJAY&nbsp;
        <span class="sanj" aria-hidden="true">
            &nbsp;SANJAY&nbsp;
        </span>
    </button>
  <div class="brand" aria-label="Netflix Logo" tabindex="0">NETFLIX</div>
  <nav class="desktop-nav" role="navigation" aria-label="Primary navigation links">
    <a href="#" class="active" aria-current="page" tabindex="0">Home</a>
    <a href="#tv-shows" tabindex="0">TV Shows</a>
    <a href="#movies" tabindex="0">Movies</a>
    <a href="#new-popular" tabindex="0">New & Popular</a>
    <a href="#my-list" tabindex="0">My List</a>
    
    <div class="search-wrapper" role="search" aria-label="Search movies and shows">
      <input type="search" id="searchInput" placeholder="Search" aria-autocomplete="list" aria-haspopup="listbox" autocomplete="off" aria-controls="searchResults" />
      <span class="material-icons-outlined" aria-hidden="true">search</span>
      <ul id="searchResults" role="listbox" aria-label="Search suggestions" tabindex="-1" style="position:absolute; top:36px; left:0; right:0; background:#222; border-radius:8px; max-height:200px; overflow:auto; display:none; z-index:1300; padding:0; margin:0;"></ul>
    </div>
           <div class="profile" aria-haspopup="menu" aria-expanded="false" aria-label="User Profile menu">
      <button class="profile-btn" id="profileBtn" aria-controls="profileMenu" aria-expanded="false" aria-haspopup="true" tabindex="0">
        <img src="profile1.jpeg" alt="User avatar" />
      </button>
      
      <nav class="profile-dropdown" role="menu" id="profileMenu" aria-label="Profile options" tabindex="-1">
        <ul>
          <li role="menuitem" tabindex="0">Account</li>
          <li role="menuitem" tabindex="0">Settings</li>
           <a href="sample.html" id="delayedlink"><li role="menuitem" tabindex="0" id="logoutBtn">Logout</li></a>
        </ul>
      </nav>
    </div>
        <div class="theme-switch" title="Toggle dark and light theme">  
      <input type="checkbox" id="themeToggle" aria-label="Toggle light and dark theme" />
      <!-- <label for="themeToggle">Dark Mode</label> --> 
       <p class="toggle-moon" id="theme" style="font-size: 20px;">🌓</p>
    </div>
  </nav>  
  <div class="mobile-header" aria-hidden="true">
    <button class="hamburger-btn" aria-label="Open navigation menu" id="mobileMenuBtn" aria-expanded="false">menu</button>
    <div class="search-wrapper" style="flex-grow:1;" role="search" aria-label="Search movies and shows">
      <input type="search" id="searchInputMobile" placeholder="Search" aria-autocomplete="list" aria-haspopup="listbox" autocomplete="off" aria-controls="searchResultsMobile" />
      <span class="material-icons-outlined" aria-hidden="true">search</span>
      <ul id="searchResultsMobile" role="listbox" aria-label="Search suggestions" tabindex="-1" style="position:absolute; top:44px; left:0; right:0; background:#222; border-radius:8px; max-height:160px; overflow:auto; display:none; z-index:1300; padding:0; margin:0;"></ul>
    </div>
    
    <button class="profile-btn" id="profileBtnMobile" aria-controls="profileMenuMobile" aria-haspopup="true" aria-expanded="false" tabindex="0" style="margin-left:12px;">
      <img src="wed.jpeg" alt="User avatar" />
    </button>
    
  </div>
  </div>
</header>
<!-- 🎬 Movie Banner Start -->
<header class="banner" id="banner">
  <div id="video-container" class="video-container">
  <iframe
  id="video"
  width="100%"
  height="100%"
    src="https://www.youtube.com/embed/VIDEO_ID?autoplay=1&mute=1&controls=0&showinfo=0&rel=0&loop=1&playlist=VIDEO_ID&vq=hd2160"
    frameborder="0"
    allow="autoplay; fullscreen"
    allowfullscreen
  ></iframe>
  </div>
  <div class="banner-overlay"></div>
  <div class="banner-content">
    <h1 id="movie-title">Loading...</h1>
    <p id="movie-description">Fetching description...</p>
    <div class="banner-buttons">
      <button class="btn play">▶ Play</button>
      <button class="btn info">ℹ More Info</button>
      <!-- <button class="btn" id="shuffle-btn">🔁 Shuffle</button>
      <button class="btn" id="mode- toggle">🌓 Toggle Mode</button> -->
    </div>
  </div>
</header>

<!-- 🎥 Modal -->
<div id="trailer-modal" class="modal">
  <div class="modal-content">
    <span id="modal-close" class="modal-close">&times;</span>
    <iframe
      id="modal-video"
      allow="autoplay; encrypted-media"
      allowfullscreen
      frameborder="0"
    ></iframe>
  </div>
</div>

<!-- 🎬 Movie Banner End -->


 

<aside class="sidebar" aria-label="Primary navigation sidebar">
  <nav>
    <a href="#" class="active" role="link" aria-current="page" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">home</span> Home
    </a>
    <a href="#tv-shows" role="link" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">live_tv</span> TV Shows
      <span class="badge" aria-label="New content">23</span>
    </a>
    <a href="#movies" role="link" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">movie</span> Movies
    </a>
    <a href="#new-popular" role="link" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">whatshot</span> New & Popular
    </a>
    <a href="#my-list" role="link" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">playlist_add</span> My List
      <span class="badge" id="myListBadge" aria-label="Items in your list" tabindex="-1">0</span>
    </a>
        <a href="#settings" role="link" tabindex="0">
      <span class="material-icons sidebar-icon" aria-hidden="true">settings</span> Settings
      <!-- <span class="badge" id="myListBadge" aria-label="Items in your list" tabindex="-1"></span> -->
    </a>
  
  </nav>
</aside>

<main role="main" tabindex="0" aria-label="Streaming content main area">
  <!-- Rows container - multiple categories -->
  <section class="search-results" id="featured">
    <header><h2>Featured</h2></header>
    <div class="row-list" tabindex="0" aria-label="Featured movies and shows" id="searchResultsContainer"></div>
  </section>
      <section class="row" id="songs">
    <header><h2>Popular Songs</h2></header>
    <div class="row-list" tabindex="0" aria-label="Movies category movies and shows"></div>
  </section>
    <section class="row" id="movies">
    <header><h2>Movies</h2></header>
    <div class="row-list" tabindex="0" aria-label="Movies category movies and shows"></div>
  </section>
   <section class="row" id="series">
    <header><h2>Series</h2></header>
    <div class="row-list" tabindex="0" aria-label="TV Shows movies and shows"></div>
  </section>
    <section class="row" id="tv-shows">
    <header><h2>TV Shows</h2></header>
    <div class="row-list" tabindex="0" aria-label="TV Shows movies and shows"></div>
  </section>
  <section class="row" id="new-popular">
    <header><h2>New & Popular</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
    <section class="row" id="love">
    <header><h2>Love</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
    <section class="row" id="romantic">
    <header><h2>Romantic</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
   <section class="row" id="horror">
    <header><h2>Horror</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
  </section>
      <section class="row" id="scifi">
    <header><h2>Sci-Fi</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
      <section class="row" id="mysterious">
    <header><h2>Mysterious</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
        <section class="row" id="crime">
    <header><h2>Crime-Thriller</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>

    <section class="row" id="kdrama">
    <header><h2>K-Drama</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
      <section class="row" id="action">
    <header><h2>Action</h2></header>
    <div class="row-list" tabindex="0" aria-label="New and popular movies and shows"></div>
  </section>
  <section class="row" id="my-list">
    <header><h2>My List</h2></header>
    <div class="row-list" tabindex="0" aria-label="User's saved movies and shows"></div>
  </section>
</main>

<footer role="contentinfo">
  <p>Netflix Clone &copy; 2025 | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a> | <a href="#">Contact</a></p>
</footer>

<!-- Video Player Modal -->
<div class="video-modal" role="dialog" aria-modal="true" aria-labelledby="videoTitle" aria-describedby="videoDescription" tabindex="-1" id="videoModal">
  <div class="video-player-container">
    <button aria-label="Close video player" class="close-video-btn" id="closeVideoBtn" title="Close video player">&times;</button>
     <div class="video-wrapper">
    <video id="videoPlayer" controls controlsList="nodownload" width="600">
      Your browser does not support the video tag.
    </video>
     </div>
    <div class="video-description" tabindex="0">
      <div class="video-title" id="videoTitle">Title</div>
      <div class="video-summary" id="videoDescription">Description</div>
    </div>
    <div class="video-controls" aria-hidden="true">
      <div class="control-buttons">
        <button id="playPauseBtn" aria-label="Play or pause video"><span class="material-icons">play_arrow</span></button>
        <span id="currentTime" class="time-display">0:00</span>
        <input type="range" id="progressBar" class="progress-bar" min="0" max="100" value="0" aria-label="Video progress" />
        <span id="duration" class="time-display">0:00</span>
        <div class="aspect-wrapper">
        <select id="aspect">
              <option value="default">Default</option>

            <option value="cinema">Cinematic (21:9)</option>   <!-- Custom handled -->
  <option value="contain">Fit </option>
    <option value="fill">Fill</option>
      <option value="cover">Crop</option>
    <option value="none">Original</option>
  <option value="centered-cover">Centered Crop</option> <!-- Custom handled -->
  <option value="portrait">Portrait (9:16)</option>     <!-- Custom handled -->
  <option value="none">None</option>
        </select>
        </div>
        <button id="muteBtn" aria-label="Mute or unmute video"><span class="material-icons">volume_up</span></button>
        <button id="fullscreenBtn" aria-label="Toggle fullscreen"><span class="material-icons">fullscreen</span></button>
      </div>
    </div>
  </div>
</div>

<div class="toast-container" aria-live="polite" aria-atomic="true"></div>


<script>
  (()=>{
    const link=document.getElementById("delayedlink");
    link.addEventListener("click",function(event){
      event.preventDefault();
      console.log("clicked")
       setTimeout(() => {
    window.location.href=link.href;
  },2000)
    })
   const aspectSelect = document.getElementById("aspect");
const video = document.getElementById("videoPlayer");
const wrapper = document.querySelector(".video-wrapper");

aspectSelect.addEventListener("change", (e) => {
  const value = e.target.value;
  console.log("Aspect changed to:", value);

  // Reset custom classes
  wrapper.classList.remove("cinema", "portrait", "centered-cover");
  video.style.objectFit = "";
  video.style.objectPosition = "";

  // Handle standard object-fit values
  const standardFits = ["contain", "cover", "fill", "none"];
  if (standardFits.includes(value)) {
    video.style.objectFit = value;
  }

  // Handle custom values
  if (value === "cinema") {
    wrapper.classList.add("cinema");
    video.style.objectFit = "cover";
  } else if (value === "portrait") {
    wrapper.classList.add("portrait");
    video.style.objectFit = "cover";
  } else if (value === "centered-cover") {
    wrapper.classList.add("centered-cover");
  }
});

   const API_KEY = 'e950e51d5d49e85f7c2f17f01eb23ba3';
const banner = document.getElementById('banner');
const videoContainer = document.getElementById('video-container');
const title = document.getElementById('movie-title');
const description = document.getElementById('movie-description');
const playBtn = document.querySelector('.btn.play');
let currentTrailerKey = null;

async function fetchTrending(minCount = 80) {
  let movies = [];
  let page = 1;

  while (movies.length < minCount && page <= 5) {
    const res = await fetch(`https://api.themoviedb.org/3/trending/movie/week?api_key=${API_KEY}&page=${page}`);
    const data = await res.json();

    for (const movie of data.results) {
      if (!movie.backdrop_path) continue;

      const trailer = await fetchTrailer(movie.id);
      if (trailer) {
        movie.trailerKey = trailer.key;
        movies.push(movie);
        if (movies.length >= minCount) break;
      }
    }

    page++;
  }

  return shuffleArray(movies); // shuffle result
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}



async function fetchTrailer(movieId) {
  const res = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/videos?api_key=${API_KEY}`);
  const data = await res.json();
  return data.results.find(v => v.site === "YouTube" && v.type === "Trailer");
}

function embedMutedTrailer(Key) {
  const videoContainer = document.getElementById('video-container');
  videoContainer.innerHTML = `
    <iframe 
      width="100%" 
      height="100%" 
      src="https://www.youtube.com/embed/${Key}?autoplay=1&mute=1&controls=0&showinfo=0&modestbranding=1&rel=0&disablekb=1&fs=0&playsinline=1"
      title="YouTube video player"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen>
    </iframe>
  `;
}




function typeWriter(text, element, speed = 40) {
  element.textContent = '';
  let i = 0;
  const interval = setInterval(() => {
    element.textContent += text.charAt(i);
    i++;
    if (i >= text.length) clearInterval(interval);
  }, speed);
}

async function showBanner(movie) {
  title.textContent = movie.title;
  typeWriter(movie.overview || '', description);
  const trailer = await fetchTrailer(movie.id);

  if (trailer) {
    currentTrailerKey = trailer.key;
    embedMutedTrailer(trailer.key);
    banner.style.backgroundImage = 'none';
  } else {
    currentTrailerKey = null;
    videoContainer.innerHTML = '';
    banner.style.backgroundImage = `url(https://image.tmdb.org/t/p/original/${movie.backdrop_path})`;
    banner.style.backgroundSize = 'cover';
    banner.style.backgroundPosition = 'center';
  }
}


let lastIndex = -1;

let movieQueue = [];
let currentIndex = 0;

async function initBanner() {
  movieQueue = await fetchTrending(50);
  if (!movieQueue.length) return;

  await showBanner(movieQueue[currentIndex]);

  setInterval(() => {
    currentIndex = (currentIndex + 1) % movieQueue.length;
    showBanner(movieQueue[currentIndex]);
  }, 25000);
}


// Play button opens modal
document.querySelector('.btn.play').addEventListener('click', () => {
  if (!currentTrailerKey) return alert("No trailer available");
  const modal = document.getElementById("trailer-modal");
  const modalVideo = document.getElementById("modal-video");
  modalVideo.src = `https://www.youtube.com/embed/${currentTrailerKey}?autoplay=1&controls=1`;
  modal.style.display = "flex";
});
function showYouTubeTrailerModal(trailerUrl, titleText, descText) {
  videoTitle.textContent = titleText;
  videoDescription.textContent = descText || 'No description available.';
  videoPlayer.src = trailerUrl;
  videoModal.classList.add('active');
  videoModal.focus();
  document.body.style.overflow = 'hidden';
}


// Close modal
document.getElementById("modal-close").addEventListener("click", () => {
  document.getElementById("trailer-modal").style.display = "none";
  document.getElementById("modal-video").src = '';
});

window.addEventListener("click", (e) => {
  const modal = document.getElementById("trailer-modal");
  if (e.target === modal) {
    modal.style.display = "none";
    document.getElementById("modal-video").src = '';
  }
});

// Start on page load
document.addEventListener('DOMContentLoaded', initBanner);



    // Dummy data with trailer URLs added (sample open videos for demo)
    const dummyData = {
      featured: [
         { id: 'f1', title: 'Lust Stories 2', trailer: 'luststories.mp4', image: 'luststories.jpeg', rating: 7.3, description: 'Robbery thriller.', type: 'tv' },
        { id: 'f2', title: 'Stranger Things', trailer: 'stranger.mp4', image: 'https://d1rgjmn2wmqeif.cloudfront.net/r/b/91943.jpg', rating: 8.6, description: 'Mystery and supernatural in Hawkins.', type: 'tv' },
         { id: 'f3', title: 'Ratsasan', trailer: 'ratsasan.mp4', image: 'ratsasan.jpeg', rating: 8.3, description: 'Zombie apocalypse heist.', type: 'movie' },
          { id: 'f4', title: 'K.G.F  2', trailer: 'Kgf 2.mp4', image: 'k3.jpeg', rating: 7.3, description: 'Robbery thriller.', type: 'tv' },
           { id: 'f5', title: 'Wednesday', trailer: 'wednesday.mkv', image: 'wed1.jpeg', rating: 8, description: 'Monster hunter Geralt of Rivia.', type: 'tv' },
        { id: 'f6', title: 'Bridgerton', trailer: 'bridge.mp4', image: 'https://m.media-amazon.com/images/I/81nnLGxKFkL._UF1000,1000_QL80_.jpg', rating: 7.4, description: 'A scandalous tale of London.', type: 'tv' },
        { id: 'f7', title: 'Extraction', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'extraction.jpeg', rating: 7.1, description: 'Rescue mission and thrills.', type: 'movie' },
        { id: 'f8', title: 'Bird Box', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'birdbox.jpeg', rating: 6.6, description: 'Survival in a mysterious world.', type: 'movie' },
      ],
            series: [
        { id: 's1', title: 'Breaking Bad', trailer: 'breakingbad.mp4', image: 'bad.jpeg', rating: 9.5, description: 'Money laundering in Missouri.', type: 'tv' },
        { id: 's2', title: 'Dark', trailer: 'dark.mp4', image: 'dark1.jpeg', rating: 8.7, description: 'Dystopian technology anthology.', type: 'tv' },
        { id: 's3', title: 'Peaky Blinders', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'https://our.today/wp-content/uploads/2024/06/MV5BZjYzZDgzMmYtYjY5Zi00YTk1LThhMDYtNjFlNzM4MTZhYzgyXkEyXkFqcGdeQXVyMTE5NDQ1MzQ3._V1_.jpg', rating: 8.7, description: 'AI theme park.', type: 'tv' },
        { id: 's4', title: 'Maze Runners', trailer: 'maze.mp4', image: 'https://rukminim3.flixcart.com/image/850/1000/xif0q/poster/x/w/1/small-spos15104-poster-the-maze-runner-sl-15117-wall-poster-original-imagkb9c6xcyhcf5.jpeg?q=20&crop=false', rating: 7.7, description: 'British monarchy history.', type: 'tv' },
        { id: 's5', title: 'Wednesday', trailer: 'wednesday.mkv', image: 'wed1.jpeg', rating: 8, description: 'Chemistry teacher to drug kingpin.', type: 'tv' },
         { id: 's6', title: 'The Witcher', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'witcher.jpeg', rating: 7.9, description: 'Survival in a mysterious world.', type: 'movie' }
      ],
           songs: [
        { id: 'sn1', title: 'Manike Mage Hithe', trailer: 'man.mp4', image: 'manike.jpg', rating: 9.5, description: 'Money laundering in Missouri.', type: 'tv' },
         { id: 'sn2', title: 'Param Sundari', trailer: 'para.mp4', image: 'param.jpeg', rating: 8, description: 'Chemistry teacher to drug kingpin.', type: 'tv' },
        { id: 'sn3', title: 'Dil Chori', trailer: 'dil.mp4', image: 'dilchori.jpeg', rating: 8.7, description: 'Dystopian technology anthology.', type: 'tv' },
        { id: 'sn4', title: 'Kusu', trailer: 'kusu.mp4', image: 'kusu.jpeg', rating: 8.7, description: 'AI theme park.', type: 'tv' },
        { id: 'sn5', title: 'Chikni Chameli', trailer: 'chik.mp4', image: 'chikni.jpeg', rating: 7.7, description: 'British monarchy history.', type: 'tv' },
      ],
      'tv-shows': [
         { id: 'tv1', title: 'Game Of Thrones', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'game.jpeg', rating: 9.2, description: 'Chemistry teacher to drug kingpin.', type: 'tv' },
        { id: 'tv2', title: 'Black Mirror', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'mirror.jpg', rating: 8.7, description: 'Dystopian technology anthology.', type: 'tv' },
        { id: 'tv3', title: 'Ozark', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'ozark.jpeg', rating: 8.4, description: 'Money laundering in Missouri.', type: 'tv' },
        { id: 'tv4', title: 'Never Have I Ever', trailer: 'Never.mp4', image: 'never.jpeg', rating: 7.7, description: 'AI theme park.', type: 'tv' },
        { id: 'tv5', title: 'The Crown', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'crown.jpeg', rating: 8.6, description: 'British monarchy history.', type: 'tv' },
        { id: 'tv6', title: 'Westworld', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'west.jpeg', rating: 8.4, description: 'AI theme park.', type: 'tv' }
      ],
      movies: [
         { id: 'm1', title: 'Fifty Shades of Grey', trailer: 'fifty.mp4', image: 'fifty.jpeg', rating: 7.9, description: 'Romantic.', type: 'movie' },
        { id: 'm2', title: 'Inception', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'incep.jpeg', rating: 8.8, description: 'Dream heist thriller.', type: 'movie' },
        { id: 'm3', title: 'John Wick', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'johnwick.jpeg', rating: 7.4, description: 'Retired hitman revenge.', type: 'movie' },
        { id: 'm4', title: 'Interstellar', trailer: 'Interstellar.mp4', image: 'interstellar.jpeg', rating: 7.5, description: 'Space exploration epic.', type: 'movie' },
        { id: 'm5', title: 'The Dark Knight', trailer: 'Dark_knight.mp4', image: 'darkknight.jpeg', rating: 9.0, description: 'Batman faces Joker.', type: 'movie' },
        { id: 'm6', title: 'Avengers: Endgame', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'avengers.jpeg', rating: 8.4, description: 'Superhero ensemble finale.', type: 'movie' }
      ],
      'new-popular': [
        { id: 'np1', title: 'Squid Game', trailer: 'squid.mp4', image: 'squidgame.jpeg', rating: 8.0, description: 'Survival game drama.', type: 'tv' },
        { id: 'np2', title: 'Money Heist', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'money.jpeg', rating: 8.2, description: 'Robbery thriller.', type: 'tv' },
        { id: 'np3', title: 'Army of the Dead', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'army.jpeg', rating: 6.8, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'np4', title: 'Red Notice', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'red1.jpeg', rating: 6.4, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'np5', title: 'The Queen’s Gambit', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'queeensgambit.jpeg', rating: 8.6, description: 'Chess prodigy drama.', type: 'tv' }
      ],
        'love': [
        { id: 'l1', title: 'Titanic', trailer: 'titanic.mp4', image: 'titanic.jpeg', rating: 8.8, description: 'Survival game drama.', type: 'tv' },
         { id: 'l2', title: 'My Fault', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'myfault.jpeg', rating: 8.0, description: 'Survival game drama.', type: 'tv' },
        { id: 'l3', title: 'Passengers', trailer: 'Passengers.mp4', image: 'passengers1.jpeg', rating: 7.7, description: 'Robbery thriller.', type: 'tv' },
        { id: 'l4', title: 'Love At First Sight', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'firstsight.jpeg', rating: 5.9, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'l5', title: 'The NoteBook', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'notebook.jpeg', rating: 7.8, description: 'Chess prodigy drama.', type: 'tv' },
        { id: 'l6', title: 'It Ends With Us', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'itendswithus.jpeg', rating: 6.4, description: 'Action-comedy thriller.', type: 'movie' }
      ],
        'romantic': [
        { id: 'r1', title: 'Fifty Shades Of Grey', trailer: 'fifty.mp4', image: 'fifty.jpeg', rating: 7.9, description: 'Survival game drama.', type: 'tv' },
        { id: 'r2', title: 'Lust Stories', trailer: 'luststories.mp4', image: 'luststories.jpeg', rating: 7.3, description: 'Robbery thriller.', type: 'tv' },
        { id: 'r3', title: 'Lucky One', trailer: 'lucky.mp4', image: 'luckyone.jpeg', rating: 6.4, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'r4', title: '365 Days', trailer: '365 Days.mp4', image: '365.jpeg', rating: 5.5, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'r5', title: 'No Hard Feelings', trailer: 'no hard.mp4', image: 'nohard.jpeg', rating: 8.0, description: 'Chess prodigy drama.', type: 'tv' }
      ],
        'horror': [
        { id: 'h1', title: 'Ring', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'ring1.jpeg', rating: 7.1, description: 'Survival game drama.', type: 'tv' },
        { id: 'h2', title: 'Mirror', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'mirror.jpeg', rating: 7.9, description: 'Robbery thriller.', type: 'tv' },
        { id: 'h3', title: 'The Excorsist', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'exorcist.jpeg', rating: 8.9, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'h4', title: 'The Conjuring', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'conjuring.jpeg', rating: 7.5, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'h5', title: 'It', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'it.jpeg', rating: 8.1, description: 'Chess prodigy drama.', type: 'tv' }
      ],
        'scifi': [
        { id: 'sf1', title: 'Interstellar', trailer: 'Interstellar.mp4', image: 'interstellar.jpeg', rating: 9.2, description: 'Survival game drama.', type: 'tv' },
        { id: 'sf2', title: 'Matrix', trailer: 'The Matrix.mp4', image: 'matrix.jpeg', rating: 8.7, description: 'Robbery thriller.', type: 'tv' },
        { id: 'sf3', title: '2001: A Space Odyssey', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'spaceodyssey.jpeg', rating: 8.3, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'sf4', title: 'Back To The Future', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'backtofuture.jpeg', rating: 8.5, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'sf5', title: 'The Martian', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'martian.jpeg', rating: 8.0, description: 'Chess prodigy drama.', type: 'tv' }
      ],
       'mysterious': [
        { id: 'm1', title: 'Zodiac', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'zodiac.jpeg', rating: 8.0, description: 'Survival game drama.', type: 'tv' },
        { id: 'm2', title: 'Sherlock Holmes', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'sherlock.jpeg', rating: 7.5, description: 'Robbery thriller.', type: 'tv' },
        { id: 'm3', title: 'Shutter Island', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'shutter.jpeg', rating: 5.9, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'm4', title: 'Shawshank Redemption', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'redemption.jpeg', rating: 6.4, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'm5', title: 'Heriditary', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'heriditary.jpeg', rating: 8.6, description: 'Chess prodigy drama.', type: 'tv' }
      ],
       'crime': [
        { id: 'c1', title: 'Joker', trailer: 'Joker.mp4', image: 'joker.jpeg', rating: 7.7, description: 'Survival game drama.', type: 'tv' },
        { id: 'c2', title: 'Drishyam', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'drishyam.jpeg', rating: 8.2, description: 'Robbery thriller.', type: 'tv' },
        { id: 'c3', title: 'Ratsasan', trailer: 'ratsasan.mp4', image: 'ratsasan.jpeg', rating: 8.3, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'c4', title: 'John Wick', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'johnwick.jpeg', rating: 7.5, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'c5', title: 'Iratta', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'iratta.jpeg', rating: 87.7, description: 'Chess prodigy drama.', type: 'tv' }
      ],
       'kdrama': [
        { id: 'k1', title: 'Ballerina', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/river.webm', image: 'ballerina.jpeg', rating: 7.3, description: 'Survival game drama.', type: 'tv' },
        { id: 'k2', title: 'The Housemaid', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'housemaid.jpeg', rating: 6.5, description: 'Robbery thriller.', type: 'tv' },
        { id: 'k3', title: 'The Roundup', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'roundup.jpeg', rating: 7.0, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'k4', title: 'Unlocked', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'unlocked.jpeg', rating: 6.4, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'k5', title: 'Tunnel', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'tunnel.jpeg', rating: 6.8, description: 'Chess prodigy drama.', type: 'tv' }
      ],
        'action': [
        { id: 'a1', title: 'Jurassic World Rebirth', trailer: 'Jurassic.mp4', image: 'jurassic.jpeg', rating: 8.5, description: 'Survival game drama.', type: 'tv' },
        { id: 'a2', title: 'Predator', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/earth.webm', image: 'predator.jpeg', rating: 7.8, description: 'Robbery thriller.', type: 'tv' },
        { id: 'a3', title: 'Extraction', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/tiger.webm', image: 'extraction.jpeg', rating: 6.8, description: 'Zombie apocalypse heist.', type: 'movie' },
        { id: 'a4', title: 'Oblivion', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/bee.webm', image: 'oblivion.jpeg', rating: 7.0, description: 'Action-comedy thriller.', type: 'movie' },
        { id: 'a5', title: 'F1', trailer: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm', image: 'f1.jpeg', rating: 8.0, description: 'Chess prodigy drama.', type: 'tv' }
      ],
      'my-list': []
    };



    /* DOM References */
    window.addEventListener('DOMContentLoaded',loadTheme);
    const main = document.querySelector('main');
   // const searchInput = document.getElementById('searchInput');
    //const searchResults = document.getElementById('searchResults');
    const themeToggle = document.getElementById('themeToggle');
    const profileBtn = document.getElementById('profileBtn');
    const profileDropdown = document.querySelector('.profile-dropdown');
    const logoutBtn = document.getElementById('logoutBtn');
    const sidebar = document.querySelector('aside.sidebar');
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const myListBadge = document.getElementById('myListBadge');
    const toastContainer = document.querySelector('.toast-container');
    const movieRows = document.querySelectorAll('.movie-row'); // Fixes the error


    // Video player modal elements
    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const closeVideoBtn = document.getElementById('closeVideoBtn');
    const videoTitle = document.getElementById('videoTitle');
    const videoDescription = document.getElementById('videoDescription');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const muteBtn = document.getElementById('muteBtn');
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    const currentTimeDisplay = document.getElementById('currentTime');
    const durationDisplay = document.getElementById('duration');
    const progressBar = document.getElementById('progressBar');

    // Manage theme preference
    function loadTheme() {
      const savedTheme = localStorage.getItem('theme') || 'dark';
      if (savedTheme === 'dark') {
        document.body.classList.add('dark-theme');
        themeToggle.checked = true;
       // document.getElementById("theme").innerHTML="🌓";
      } else {
        document.body.classList.remove('dark-theme');
        themeToggle.checked = false;
       // document.getElementById("theme").innerHTML="🌓";
      }
    }
    function toggleTheme() {
      if (themeToggle.checked) {
        document.body.classList.add('dark-theme');
        localStorage.setItem('theme', 'dark');
       // document.getElementById("theme").innerHTML="🌓";
      } else {
        document.body.classList.remove('dark-theme');
        localStorage.setItem('theme', 'light');
       // document.getElementById("theme").innerHTML="🌓";
      }
      showToast('Theme changed successfully', 'success');
    }

    // Toast notification system
    function showToast(message, type = '', icon = '') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.setAttribute('role', 'alert');
      toast.innerHTML = `<span class="material-icons" aria-hidden="true">${icon}</span><div>${message}</div><button aria-label="Close notification" class="toast-close-btn" type="button">&times;</button>`;
      toastContainer.appendChild(toast);

      const closeBtn = toast.querySelector('.toast-close-btn');
      closeBtn.addEventListener('click', () => {
        toastContainer.removeChild(toast);
      });

      setTimeout(() => {
        if(toast.parentNode === toastContainer){
          toastContainer.removeChild(toast);
        }
      }, 5000);
    }

    // Render movie/show rows with play button overlay and duration info
    function renderRow(sectionId, items) {
      const section = document.getElementById(sectionId);
      const container = section.querySelector('.row-list');
      container.innerHTML = ''; // clear

      items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.setAttribute('tabindex', '0');
        card.setAttribute('role', 'button');
        card.setAttribute('aria-label', `${item.title}, rating: ${item.rating}`);

        // Content
        card.innerHTML = `
          <img src="${item.image}" alt="Poster image for ${item.title}" loading="lazy" />
          <div class="card-title" title="${item.title}">${item.title}</div>
          <div class="card-details">
            <div class="card-rating" aria-label="Rating: ${item.rating}">
              <span class="material-icons" aria-hidden="true">star</span>${item.rating.toFixed(1)}
            </div>
            <button class="card-fav ${isInMyList(item.id) ? 'favorited' : ''}" aria-pressed="${isInMyList(item.id)}" aria-label="Toggle favorite ${item.title}" data-id="${item.id}" type="button">
              <span class="material-icons">${isInMyList(item.id) ? 'favorite' : 'favorite_border'}</span>
            </button>
          </div>
          <div class="play-overlay" aria-hidden="true">
            <button class="play-button" aria-label="Play ${item.title}" data-id="${item.id}" type="button" tabindex="-1">
              <span class="material-icons">play_arrow</span> Play
            </button>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Check if item is in My List
    function isInMyList(id) {
      return dummyData['my-list'].some(item => item.id === id);
    }
    
    // Add or remove from My List
    function toggleFavorite(id) {
      const allItems = [].concat(
        dummyData.featured,
        dummyData['tv-shows'],
        dummyData.songs,
        dummyData.movies,
        dummyData.series,
        dummyData.love,
        dummyData.romantic,
        dummyData.horror,
        dummyData.scifi,
        dummyData.mysterious,
        dummyData.crime,
        dummyData.kdrama,
        dummyData.action,
        dummyData['new-popular']
      );
      const item = allItems.find(it => it.id === id);
      if(!item) {
        showToast('Item not found', 'error', 'error');
        return;
      }
      if(isInMyList(id)) {
        dummyData['my-list'] = dummyData['my-list'].filter(it => it.id !== id);
        showToast(`${item.title} removed from My List`, 'info', 'remove_circle');
      } else {
        dummyData['my-list'].push(item);
        showToast(`${item.title} added to My List`, 'success', 'check_circle');
      }
      updateMyListUI();
      renderRow('my-list', dummyData['my-list']);
      updateSidebarBadge();
      saveMyList();
    }

    // Update My List badge
    function updateSidebarBadge() {
      myListBadge.textContent = dummyData['my-list'].length;
      if (dummyData['my-list'].length === 0) {
        myListBadge.classList.add('hidden');
      } else {
        myListBadge.classList.remove('hidden');
      }
    }

    // Save My List to localStorage
    function saveMyList() {
      localStorage.setItem('myList', JSON.stringify(dummyData['my-list']));
    }

    // Load My List from localStorage
    function loadMyList() {
      const saved = localStorage.getItem('myList');
      if (saved) {
        try {
          dummyData['my-list'] = JSON.parse(saved);
        } catch {
          dummyData['my-list'] = [];
        }
      }
      updateSidebarBadge();
    }

    // Update UI for My List favorite icons
    function updateMyListUI() {
      const favBtns = document.querySelectorAll('.card-fav');
      favBtns.forEach(btn => {
        const id = btn.dataset.id;
        if (isInMyList(id)) {
          btn.classList.add('favorited');
          btn.setAttribute('aria-pressed', 'true');
          btn.querySelector('span.material-icons').textContent = 'favorite';
        } else {
          btn.classList.remove('favorited');
          btn.setAttribute('aria-pressed', 'false');
          btn.querySelector('span.material-icons').textContent = 'favorite_border';
        }
      });
    }

    // Search filtering for the search input
    function searchLocalMovies(query) {
  if (!query || typeof query !== 'string') return [];

  const lowerQuery = query.toLowerCase();
   const allItems = [].concat(
    dummyData.featured,
    dummyData.songs,
    dummyData['tv-shows'],
    dummyData.movies,
    dummyData.series,
    dummyData.love,
    dummyData.romantic,
    dummyData.horror,
    dummyData.scifi,
    dummyData.mysterious,
    dummyData.crime,
    dummyData.kdrama,
    dummyData.action,
    dummyData['new-popular'],
    dummyData['my-list']
  );

  for (const key in dummyData) {
    const section = dummyData[key];
    if (Array.isArray(section)) {
      allItems.push(...section);
    }
  }

  const results = allItems.filter(item =>
    item.title && item.title.toLowerCase().includes(lowerQuery)
  );

  console.log("🔍 Searching all rows for:", query);
  console.log("✅ Found results:", results);

  return results;
}

 


console.log("Searching in items:", dummyData);


    // Render search results suggestions
    function renderSearchResults(results, container) {
      if(results.length === 0) {
        container.style.display = 'none';
        container.innerHTML = '';
        return;
      }
      container.innerHTML = results.slice(0, 8).map(item => `
        <li role="option" tabindex="0" data-id="${item.id}" aria-label="${item.title}">${item.title}</li>
      `).join('');
      container.style.display = 'block';
    }

    // Handle search input event for desktop
    function onSearchInput(e) {
      const query = e.target.value.trim();
      const results = filterSearch(query);
      renderSearchResults(results, searchResults);
    }
    // Handle clicks on search suggestions
    function onSearchSelect(e) {
      if(e.target.matches('li[data-id]')) {
        const id = e.target.dataset.id;
        searchInput.value = e.target.textContent;
        searchResults.style.display = 'none';
        showToast(`Selected: ${e.target.textContent}`, 'info', 'info');
        // Could scroll to or highlight item in UI
        // For demo just log
        console.log('Selected item id:', id);
      }
    }

    // Profile dropdown toggle
    function toggleProfileMenu() {
      const expanded = profileBtn.getAttribute('aria-expanded') === 'true';
      if(expanded) {
        profileBtn.setAttribute('aria-expanded', 'false');
        profileDropdown.classList.remove('active');
      } else {
        profileBtn.setAttribute('aria-expanded', 'true');
        profileDropdown.classList.add('active');
        profileDropdown.focus();
      }
    }

    // Close profile menu
    function closeProfileMenu() {
      profileBtn.setAttribute('aria-expanded', 'false');
      profileDropdown.classList.remove('active');
    }

    // Keyboard navigation focus trap for profile menu
    function handleProfileMenuKeyDown(e) {
      if(e.key === 'Escape') {
        e.preventDefault();
        closeProfileMenu();
        profileBtn.focus();
      }
    }

    // Logout simulation
    function logout() {
      closeProfileMenu();
      showToast('Logging out', 'success', 'logout');
      // Clear data or simulate logout action
    }

    // Mobile sidebar toggling
    function toggleSidebar() {
      if(sidebar.classList.contains('open')) {
        sidebar.classList.remove('open');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      } else {
        sidebar.classList.add('open');
        mobileMenuBtn.setAttribute('aria-expanded', 'true');
        document.body.style.overflow = 'hidden';
      }
    }

    // Close mobile sidebar if open
    function closeSidebar() {
      if(sidebar.classList.contains('open')) {
        sidebar.classList.remove('open');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');
        document.body.style.overflow = '';
      }
    }

    // Handle card favorite button clicks (event delegation)
    function onCardFavoriteClick(e) {
      const btn = e.target.closest('button.card-fav');
      if(btn) {
        e.stopPropagation();
        const id = btn.dataset.id;
        toggleFavorite(id);
      }
    }

    // Play video function
    function openVideoPlayer(itemId) {
      const allItems = [].concat(
        dummyData.featured,
        dummyData.songs,
        dummyData['tv-shows'],
        dummyData.movies,
        dummyData.series,
        dummyData.love,
        dummyData.romantic,
        dummyData.horror,
        dummyData.scifi,
        dummyData.mysterious,
        dummyData.crime,
        dummyData.kdrama,
        dummyData.action,
        dummyData['new-popular'],
        dummyData['my-list']
      );
      const item = allItems.find(it => it.id === itemId);
      if (!item || !item.trailer) {
        showToast('Trailer not available', 'error', 'error');
        return;
      }
      videoTitle.textContent = item.title;
      videoDescription.textContent = item.description || 'No description available.';
      videoPlayer.src = item.trailer;
      videoPlayer.currentTime = 0;
      videoPlayer.play();
      videoModal.classList.add('active');
      videoModal.focus();
      document.body.style.overflow = 'hidden';
      updatePlayPauseIcon();
      updateMuteIcon();
    }

    // Close video player modal
    function closeVideoPlayer() {
      videoModal.classList.remove('active');
      videoPlayer.pause();
      videoPlayer.src = '';
      document.body.style.overflow = '';
      // Return focus to last focused element or main area
      main.focus();
    }
    
    // Update play/pause button icon
    function updatePlayPauseIcon() {
      if(videoPlayer.paused) {
        playPauseBtn.querySelector('span').textContent = 'play_arrow';
      } else {
        playPauseBtn.querySelector('span').textContent = 'pause';
      }
    }

    // Toggle play/pause
    function togglePlayPause() {
      if(videoPlayer.paused) {
        videoPlayer.play();
      } else {
        videoPlayer.pause();
      }
      updatePlayPauseIcon();
    }

    // Update mute button icon
    function updateMuteIcon() {
      if(videoPlayer.muted || videoPlayer.volume === 0) {
        muteBtn.querySelector('span').textContent = 'volume_off';
      } else {
        muteBtn.querySelector('span').textContent = 'volume_up';
      }
    }

    // Toggle mute
    function toggleMute() {
      videoPlayer.muted = !videoPlayer.muted;
      updateMuteIcon();
    }

    // Format seconds to mm:ss
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = Math.floor(seconds % 60);
      return `${m}:${s.toString().padStart(2, '0')}`;
    }

    // Update time displays and progress bar
    function updateProgress() {
      currentTimeDisplay.textContent = formatTime(videoPlayer.currentTime);
      durationDisplay.textContent = formatTime(videoPlayer.duration || 0);
      const percent = (videoPlayer.currentTime / videoPlayer.duration) * 100 || 0;
      progressBar.value = percent;
    }

    // Seek video on progress bar change
    function onProgressChange(e) {
      if(videoPlayer.duration) {
        videoPlayer.currentTime = (e.target.value / 100) * videoPlayer.duration;
      }
    }

    // Toggle fullscreen mode for video modal
    function toggleFullscreen() {
      if(!document.fullscreenElement) {
        videoModal.requestFullscreen().catch(err => {
          showToast('Fullscreen not supported', 'error', 'error');
        });
      } else {
        document.exitFullscreen();
      }
    }

    // Keyboard shortcuts handler
    function onKeyDown(e) {
      if(e.key === 'Escape') {
        if(videoModal.classList.contains('active')) {
          closeVideoPlayer();
        } else {
          closeProfileMenu();
          closeSidebar();
          searchResults.style.display = 'none';
          searchResultsMobile.style.display = 'none';
        }
      }
      // Ctrl + M to open my list
      if(e.ctrlKey && e.key.toLowerCase() === 'm') {
        e.preventDefault();
        document.getElementById('my-list').scrollIntoView({behavior:'smooth'});
        showToast('Navigated to My List (Ctrl + M)', 'info', 'info');
      }
      // Ctrl + S to focus search input
      if(e.ctrlKey && e.key.toLowerCase() === 's') {
        e.preventDefault();
        if(window.innerWidth <= 767){
          searchInputMobile.focus();
        } else {
          searchInput.focus();
        }
        showToast('Focused Search Input (Ctrl + S)', 'info', 'info');
      }
    }

    // Event delegation for play button clicks on cards
    function onCardPlayClick(e) {
      const playBtn = e.target.closest('button.play-button');
      if(playBtn) {
        e.stopPropagation();
        const id = playBtn.dataset.id;
        openVideoPlayer(id);  
      }
    }

    // Init render all rows on page load
    function renderAllRows() {
      Object.keys(dummyData).forEach(sectionId => {
        renderRow(sectionId, dummyData[sectionId]);
      });
    }

    // Initialize app
    function init() {
      loadMyList();
      loadTheme();
      renderAllRows();
      updateMyListUI();
      updateSidebarBadge();

      // Event listeners
      themeToggle.addEventListener('change', toggleTheme);
      profileBtn.addEventListener('click', toggleProfileMenu);
     profileDropdown.addEventListener('keydown', handleProfileMenuKeyDown);
      logoutBtn.addEventListener('click', logout);
      document.body.addEventListener('click', e => {
        if (!profileDropdown.contains(e.target) && e.target !== profileBtn) {
          closeProfileMenu();
        }
        if(!searchResults.contains(e.target) && e.target !== searchInput) {
          searchResults.style.display = 'none';
        }
        if(!searchResultsMobile.contains(e.target) && e.target !== searchInputMobile) {
          searchResultsMobile.style.display = 'none';
        }
      });
    
      searchResults.addEventListener('click', onSearchSelect);
      searchResults.addEventListener('keydown', e => {
        if(e.key === 'Enter' && e.target.matches('li')) {
          e.preventDefault();
          e.target.click();
          searchInput.focus();
        }
      });
      sidebar.addEventListener('click', e => {
        const link = e.target.closest('a');
        if(link) closeSidebar();
      });
      mobileMenuBtn.addEventListener('click', toggleSidebar);

      main.addEventListener('click', onCardFavoriteClick);
      main.addEventListener('click', onCardPlayClick);

      closeVideoBtn.addEventListener('click', closeVideoPlayer);

      playPauseBtn.addEventListener('click', togglePlayPause);
      muteBtn.addEventListener('click', toggleMute);
      fullscreenBtn.addEventListener('click', toggleFullscreen);
      videoPlayer.addEventListener('timeupdate', updateProgress);
      videoPlayer.addEventListener('ended', () => {
        playPauseBtn.querySelector('span').textContent = 'replay';
      });
      progressBar.addEventListener('input', onProgressChange);

      document.addEventListener('keydown', onKeyDown);
    }

    // Run init at DOMContentLoaded
    document.addEventListener('DOMContentLoaded', init);

    const searchInput = document.getElementById('searchInput');
const searchResultsSection = document.getElementById('search-results');
const searchResultsContainer = document.getElementById('searchResultsContainer');

// ✅ TMDB Search Function
async function searchTMDB(query) {
  if (!query) return [];

  try {
    const res = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=${encodeURIComponent(query)}`);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();

    const movies = data.results.slice(0, 6);

    // ✅ Fetch trailers in parallel
    const results = await Promise.all(
      movies.map(async (movie) => {
        const trailerRes = await fetch(`https://api.themoviedb.org/3/movie/${movie.id}/videos?api_key=${API_KEY}`);
        const trailerData = await trailerRes.json();

        // const trailerObj = trailerData.results.find(v => v.site === "YouTube" && v.type === "Trailer");
        // const trailerUrl = trailerObj ? `https://www.youtube.com/embed/${trailerObj.key}?autoplay=1&mute=1&enablejsapi=1` : null;

        // return {
        //   id: 'tmdb_' + movie.id,
        //   title: movie.title,
        //   description: movie.overview || 'No description available.',
        //   image: movie.poster_path ? `https://image.tmdb.org/t/p/w500${movie.poster_path}` : '',
        //   trailer: trailerUrl // ✅ This is now a working trailer URL
        // };

        const trailerObj = trailerData.results.find(v => v.site === "YouTube" && v.type === "Trailer");
const trailerKey = trailerObj?.key;
const trailerUrl = trailerKey ? `https://www.youtube.com/embed/${trailerKey}?autoplay=1&mute=1&enablejsapi=1` : null;

return {
  id: 'tmdb_' + movie.id,
  title: movie.title,
  description: movie.overview || 'No description available.',
  image: movie.poster_path ? `https://image.tmdb.org/t/p/w500${movie.poster_path}` : '',
  trailer: trailerUrl,        // ✅ for playing directly
  trailerKey: trailerKey      // ✅ for unmuted playback later
};

      })
    );

    return results;

  } catch (err) {
    console.error('TMDB Search Failed:', err);
    return [];
  }
}



// ✅ Trailer fetch
async function fetchTMDBTrailer(movieId) {
  try {
    const res = await fetch(`https://api.themoviedb.org/3/movie/${movieId}/videos?api_key=${API_KEY}`);
    const data = await res.json();
    console.log("All TMDB video results:", data.results);

    const trailer = data.results.find(
      v => v.site === "YouTube" && v.type === "Trailer"
    );

    if (trailer && trailer.key) {
      const url = `https://www.youtube.com/embed/${trailer.key}?autoplay=1&mute=1&enablejsapi=1`;
      return { key: trailer.key, url };
    }

    return null;
  } catch (err) {
    console.error("Error fetching trailer:", err);
    return null;
  }
}



function getPreferredVideo(videos) {
  return (
    videos.find(v => v.type === 'Trailer' && v.site === 'YouTube') ||
    videos.find(v => v.type === 'Teaser' && v.site === 'YouTube') ||
    videos.find(v => v.type === 'Clip' && v.site === 'YouTube')
  );
}










// ✅ Render cards
function renderSearchResultsUI(results) {
  const container = document.getElementById('searchResultsContainer');
  container.innerHTML = '';

  if (!results.length) {
    container.innerHTML = '<p style="color:white;">No results found.</p>';
    return;
  }

  results.forEach(item => {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img src="${item.image}" alt="${item.title}" />
      <div class="card-title">${item.title}</div>
      <div class="play-overlay">
        <button class="play-button" data-id="${item.id}" data-source="tmdb">
          <span class="material-icons">play_arrow</span> Play
        </button>
      </div>
    `;
    container.appendChild(card);
  });
}

let latestSearchResults = [];


// ✅ Play trailer
searchResultsContainer.addEventListener('click', async (e) => {
  const playBtn = e.target.closest('.play-button');
  if (!playBtn) return;

  const id = playBtn.dataset.id;
  const source = playBtn.dataset.source;

  // Find item from local or latestSearchResults
  let item;
  if (source === 'local') {
    item = searchLocalMovies('').concat(dummyData.series, dummyData.action, dummyData['new-popular']).find(x => x.id === id);
    playLocalTrailerInBanner(item);
  } else {
    item = latestSearchResults.find(x => x.id === id);
    if (!item) {
      showToast("Movie not found", "error", "error");
      return;
    }

    // ✅ --- Place your code here ---
    title.textContent = item.title;
    typeWriter(item.description || 'No description available.', description);

    const trailerKey = item.trailer?.split('/embed/')[1]?.split('?')[0];
    if (!trailerKey) {
      showToast("Trailer not available", "error", "error");
      return;
    }

    currentTrailerKey = trailerKey;
    hasUnmuted = false;

    const mutedUrl = `https://www.youtube.com/embed/${trailerKey}?autoplay=1&mute=1&controls=0&rel=0&showinfo=0`;

    banner.style.backgroundImage = 'none';
    videoContainer.innerHTML = `
      <iframe
        src="${mutedUrl}"
        class="banner-video"
        frameborder="0"
        allow="autoplay; encrypted-media"
        allowfullscreen
      ></iframe>
    `;

    const hint = document.getElementById('tapToUnmute');
    if (hint) hint.style.display = 'block';

    banner.scrollIntoView({ behavior: 'smooth' });
  }
});


function embedUnmutedTrailer(key) {
  const unmutedUrl = `https://www.youtube.com/embed/${key}?autoplay=1&mute=0&controls=0&rel=0&showinfo=0`;
  videoContainer.innerHTML = `
    <iframe
      src="${unmutedUrl}"
      class="banner-video"
      frameborder="0"
      allow="autoplay; encrypted-media"
      allowfullscreen
    ></iframe>
  `;
}


document.addEventListener('click', () => {
  if (!hasUnmuted && currentTrailerKey) {
    embedUnmutedTrailer(currentTrailerKey);
    hasUnmuted = true;
    const hint = document.getElementById('tapToUnmute');
    if (hint) hint.style.display = 'none';
  }
}, { once: true });


document.addEventListener('click', () => {
  if (!hasUnmuted && currentTrailerKey) {
    embedUnmutedTrailer(currentTrailerKey);
    hasUnmuted = true;
    const hint = document.getElementById('tapToUnmute');
    if (hint) hint.style.display = 'none';
  }
}, { once: true });



// Search dummyData only
function searchLocalMovies(query) {
  if (typeof query !== 'string') return [];

  const allItems = [].concat(
    dummyData.featured,
    dummyData.songs,
    dummyData['tv-shows'],
    dummyData.movies,
    dummyData.series,
    dummyData.love,
    dummyData.romantic,
    dummyData.horror,
    dummyData.scifi,
    dummyData.mysterious,
    dummyData.crime,
    dummyData.kdrama,
    dummyData.action,
    dummyData['new-popular'],
    dummyData['my-list']
  );
  const seentitles=new Set();
  const filteredresults=[]
  for(const item of allItems){
    const title=item.title?.toLowerCase();
    if(title && title.includes(query.toLowerCase()) && !seentitles.has(title)){
      seentitles.add(title)
      filteredresults.push(item)
    }
  }
  return filteredresults

}
async function displaySearchResults(query) {
  const section = document.getElementById('search-results'); // or use searchResultsSection if globally defined
  if (section) section.classList.remove('hidden');

  searchResultsContainer.innerHTML = '';
  
  // 🔍 Log dummyData before searching
  console.log("Searching in items:", dummyData);

  const localResults = searchLocalMovies(query);
  let results = [...localResults];

  if (localResults.length === 0) {
    const tmdbResults = await searchTMDB(query);
    console.log("TMDB Results:", tmdbResults);
    results = tmdbResults;
  }

  if (results.length === 0) {
    searchResultsContainer.innerHTML = '<p style="color: white;">No results found.</p>';
    return;
  }
latestSearchResults = results;


  for (const item of results) {
    const isLocal = !item.id.startsWith('tmdb_');

    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
      <img src="${item.image}" alt="${item.title}" />
      <div class="card-title">${item.title}</div>
      <div class="play-overlay">
        <button class="play-button" data-id="${item.id}" data-source="${isLocal ? 'local' : 'tmdb'}">
          <span class="material-icons">play_arrow</span> Play
        </button>
      </div>
    `;
    searchResultsContainer.appendChild(card);
  }

  if (searchResultsSection) searchResultsSection.classList.remove('hidden'); // safe check
}





searchInput.addEventListener('input', e => {
  const query = e.target.value.trim();
  if (!query) {
    if (searchResultsSection) {
      searchResultsSection.classList.add('hidden');
    }
    return;
  }
  displaySearchResults(query);
});




  
    let hasUnmuted = false;

document.addEventListener('click', () => {
  if (!hasUnmuted && currentTrailerKey) {
    // Delay allows iframe to be properly replaced and autoplay with sound
    setTimeout(() => {
      embedUnmutedTrailer(currentTrailerKey);
    }, 100); // slightly longer delay improves reliability
    hasUnmuted = true;

    const hint = document.getElementById('tapToUnmute');
    if (hint) hint.style.display = 'none';
  }
}, { once: true });


    // Listen for first user interaction anywhere on the page
function enableSoundAfterInteraction() {
  if (currentTrailerKey && !hasUnmuted) {
    embedUnmutedTrailer(currentTrailerKey);
    hasUnmuted = true;

    const hint = document.getElementById('tapToUnmute');
    if (hint) hint.style.display = 'none';
  }
}

// Run only once on first user interaction
['click', 'keydown', 'touchstart'].forEach(event => {
  document.addEventListener(event, enableSoundAfterInteraction, { once: true });
});


// Only run this once after actual user interaction
['click', 'keydown', 'touchstart'].forEach(event => {
  document.addEventListener(event, enableSoundAfterInteraction, { once: true });
});

document.addEventListener('DOMContentLoaded', () => {
  const modalClose = document.getElementById("modal-close");
  if (modalClose) {
    modalClose.addEventListener("click", () => {
      // your logic here
    });
  } else {
    console.warn("#modal-close not found");
  }
});

function playLocalTrailerInBanner(item) {
  currentTrailerKey = null;
  title.textContent = item.title;
  typeWriter(item.description || '', description);

  banner.style.backgroundImage = 'none';
  videoContainer.innerHTML = `
    <video autoplay controls class="banner-video">
      <source src="${item.trailer}" type="video/webm">
      Your browser does not support the video tag.
    </video>
  `;

  banner.scrollIntoView({ behavior: 'smooth' });
}




    
  })();
</script>
</body>
</html>

